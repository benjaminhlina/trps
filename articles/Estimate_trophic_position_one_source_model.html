<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate trophic position - one source model • trps</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate trophic position - one source model">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Estimate_trophic_position_one_source_model.html">Estimate trophic position - one source model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/benjaminhlina/trps/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate trophic position - one source model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/benjaminhlina/trps/blob/main/vignettes/Estimate_trophic_position_one_source_model.Rmd" class="external-link"><code>vignettes/Estimate_trophic_position_one_source_model.Rmd</code></a></small>
      <div class="d-none name"><code>Estimate_trophic_position_one_source_model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="our-objectives">Our Objectives<a class="anchor" aria-label="anchor" href="#our-objectives"></a>
</h2>
<p>The purpose of this vignette is to learn how to estimate trophic
position of a species using stable isotope data
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta^{13}C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta^{15}N</annotation></semantics></math>).
We can estiamte trophic psoition using a one source model based on
equations from <a href="ttps://esajournals.onlinelibrary.wiley.com/doi/abs/10.1890/0012-9658%282002%29083%5B0703%3AUSITET%5D2.0.CO%3B2">Post
2002</a>.</p>
</div>
<div class="section level2">
<h2 id="trophic-position-model">Trophic Position Model<a class="anchor" aria-label="anchor" href="#trophic-position-model"></a>
</h2>
<p>For a one source model from <a href="ttps://esajournals.onlinelibrary.wiley.com/doi/abs/10.1890/0012-9658%282002%29083%5B0703%3AUSITET%5D2.0.CO%3B2">Post
2002</a> the equation consists of the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Trophic Position</mtext><mo>=</mo><mi>λ</mi><mo>+</mo><mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>δ</mi><mn>15</mn></msup><msub><mi>N</mi><mi>c</mi></msub><mo>−</mo><msup><mi>δ</mi><mn>15</mn></msup><msub><mi>N</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>Δ</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\text{Trophic Position} = \lambda + \frac{(\delta^{15}N_c - \delta^{15}N_b)}{\Delta N}
</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is the trophic position of the baseline (e.g., <code>2</code>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><msub><mi>N</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\delta^{15}N_c</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta^{15}N</annotation></semantics></math>
of the consumer,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><msub><mi>N</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">\delta^{15}N_b</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta^{15}N</annotation></semantics></math>
of the baseline, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">\Delta N</annotation></semantics></math>
is the trophic enrichment factor (e.g., 3.4).</p>
<p>To use this model with a Bayesian framework deployed by
<code><a href="../reference/one_source_model.html">one_source_model()</a></code> in {trps}, we need to rearrange this
equation to the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><msub><mi>N</mi><mi>c</mi></msub><mo>=</mo><msup><mi>δ</mi><mn>15</mn></msup><msub><mi>N</mi><mi>b</mi></msub><mo>+</mo><mi>Δ</mi><mi>N</mi><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Trophic Position</mtext><mo>−</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\delta^{15}N_c = \delta^{15}N_b + \Delta N \times (\text{Trophic Position} - \lambda)  
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="vignette-structure">Vignette structure<a class="anchor" aria-label="anchor" href="#vignette-structure"></a>
</h2>
<p>First we will need to organize the data prior to running the model.
To do this work we will use <a href="https://dplyr.tidyverse.org/" class="external-link">{dplyr}</a> and <a href="https://tidyr.tidyverse.org/" class="external-link">{tidyr}</a> but we could also use <a href="https://rdatatable.gitlab.io/data.table/" class="external-link">{data.table}</a> to do
this work.</p>
<p>When running the model we will use <a href="https://benjaminhlina.github.io/trps/">{trps}</a> and <a href="https://paulbuerkner.com/brms/" class="external-link">{brms}</a> and iterative processes
provided by <a href="https://purrr.tidyverse.org/" class="external-link">{purrr}</a>.</p>
<p>Once we have run the model we will use <a href="https://mc-stan.org/bayesplot/" class="external-link">{bayesplot}</a> to assess models
and then extract posterior draws using <a href="https://easystats.github.io/bayestestR/" class="external-link">{bayestestR}</a> and <a href="http://mjskay.github.io/tidybayes/" class="external-link">{tidybayes}</a>. Posterior
distributions will be plotted using <a href="https://ggplot2.tidyverse.org/" class="external-link">{ggplot2}</a> and <a href="https://mjskay.github.io/ggdist/" class="external-link">{ggdist}</a>.</p>
</div>
<div class="section level2">
<h2 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h2>
<p>Below we will load all the packages needed to carry out the
anlaysis</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/" class="external-link">bayestestR</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/" class="external-link">tidybayes</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://benjaminhlina.github.io/trps/">trps</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="assess-data">Assess data<a class="anchor" aria-label="anchor" href="#assess-data"></a>
</h2>
<p>In <a href="https://benjaminhlina.github.io/trps/">{trps}</a> we have
several data sets, they include stable isotope data
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta^{13}C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta^{15}N</annotation></semantics></math>)
for a consumer, lake trout (<em>Salvelinus namaycush</em>), a benthic
baseline, amphipods, and a pelagic baseline, dreissenids for two
ecoregions in Lake Ontario.</p>
<div class="section level3">
<h3 id="consumer-data">Consumer data<a class="anchor" aria-label="anchor" href="#consumer-data"></a>
</h3>
<p>We will check out each data set with the first being the
consumer.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consumer_iso</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 4</span></span></span>
<span><span class="co">#&gt;    common_name ecoregion  d13c  d15n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.9</span>  15.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.5</span>  16.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.8</span>  17.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.5</span>  16.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.5</span>  16.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.9</span>  16.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.3</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span></code></pre></div>
<p>We can see that this data set contains the common name of the
consumer (<code>common_name</code>), the ecoregion samples were
collected (<code>ecoregion</code>) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta^{13}C</annotation></semantics></math>
(<code>d13c</code>) and and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta^{15}N</annotation></semantics></math>
(<code>d15n</code>).</p>
</div>
<div class="section level3">
<h3 id="baseline-data">Baseline data<a class="anchor" aria-label="anchor" href="#baseline-data"></a>
</h3>
<p>Next for this vignette we will only assess benthic baseline data
set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline_1_iso</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 4</span></span></span>
<span><span class="co">#&gt;    common_name ecoregion    c1    n1</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Amphipoda   Embayment -<span style="color: #BB0000;">26.2</span>  8.44</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Amphipoda   Embayment -<span style="color: #BB0000;">26.6</span>  8.77</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Amphipoda   Embayment -<span style="color: #BB0000;">26.0</span>  8.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Amphipoda   Embayment -<span style="color: #BB0000;">22.1</span> 13.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Amphipoda   Embayment -<span style="color: #BB0000;">24.3</span>  6.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Amphipoda   Embayment -<span style="color: #BB0000;">22.1</span>  7.95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Amphipoda   Embayment -<span style="color: #BB0000;">24.7</span>  7.37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Amphipoda   Embayment -<span style="color: #BB0000;">26.6</span>  6.93</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Amphipoda   Embayment -<span style="color: #BB0000;">24.6</span>  6.97</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Amphipoda   Embayment -<span style="color: #BB0000;">22.1</span>  7.95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Amphipoda   Embayment -<span style="color: #BB0000;">24.7</span>  7.37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Amphipoda   Embayment -<span style="color: #BB0000;">22.1</span>  7.95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Amphipoda   Embayment -<span style="color: #BB0000;">24.7</span>  7.37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> Amphipoda   Embayment -<span style="color: #BB0000;">26.9</span> 10.2</span></span></code></pre></div>
<p>We can see that this data set contains the common name of the
baseline (<code>common_name</code>), the ecoregion samples were
collected (<code>ecoregion</code>) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta^{13}C</annotation></semantics></math>
(<code>d13c</code>) and and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta^{15}N</annotation></semantics></math>
(<code>d15n</code>).</p>
</div>
</div>
<div class="section level2">
<h2 id="organizing-data">Organizing data<a class="anchor" aria-label="anchor" href="#organizing-data"></a>
</h2>
<p>Now that we understand the data we need to combine both data sets to
estimate trophic position for our consumer. To do this we first need to
make an <code>id</code> column in each data set that will assist in
joining them together.</p>
<div class="section level3">
<h3 id="consumer-data-1">Consumer data<a class="anchor" aria-label="anchor" href="#consumer-data-1"></a>
</h3>
<p>Let’s first add <code>id</code> to <code>consumer_iso</code> data
frame.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consumer_iso</span> <span class="op">&lt;-</span> <span class="va">consumer_iso</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">common_name</span>, <span class="va">ecoregion</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">common_name</span><span class="op">:</span><span class="va">d15n</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="baseline-data-1">Baseline data<a class="anchor" aria-label="anchor" href="#baseline-data-1"></a>
</h3>
<p>Next let’s add <code>id</code> to <code>baseline_1_iso</code> data
frame. For joining purposes we are going to drop
<code>common_name</code> from this data frame.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline_1_iso</span> <span class="op">&lt;-</span> <span class="va">baseline_1_iso</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">common_name</span>, <span class="va">ecoregion</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">ecoregion</span><span class="op">:</span><span class="va">n1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="joining-isotope-data">Joining isotope data<a class="anchor" aria-label="anchor" href="#joining-isotope-data"></a>
</h3>
<p>Now that we have both the consumer and baseline in a consistent
structure we can join them using <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> from {dplyr}.
We will also add in the constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
(<code>l1</code>) to our data frame.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_iso_os</span> <span class="op">&lt;-</span> <span class="va">consumer_iso</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">baseline_1_iso</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"ecoregion"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    l1 <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We can see that we have successfully combined our consumer and
baseline data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_iso_os</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 8</span></span></span>
<span><span class="co">#&gt;       id common_name ecoregion  d13c  d15n    c1    n1    l1</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 Lake Trout  Embayment -<span style="color: #BB0000;">22.9</span>  15.9 -<span style="color: #BB0000;">26.2</span>  8.44     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 Lake Trout  Embayment -<span style="color: #BB0000;">22.5</span>  16.2 -<span style="color: #BB0000;">26.6</span>  8.77     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 Lake Trout  Embayment -<span style="color: #BB0000;">22.8</span>  17.0 -<span style="color: #BB0000;">26.0</span>  8.05     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.6 -<span style="color: #BB0000;">22.1</span> 13.6      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 Lake Trout  Embayment -<span style="color: #BB0000;">22.5</span>  16.6 -<span style="color: #BB0000;">24.3</span>  6.99     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.6 -<span style="color: #BB0000;">22.1</span>  7.95     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.6 -<span style="color: #BB0000;">24.7</span>  7.37     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 Lake Trout  Embayment -<span style="color: #BB0000;">22.5</span>  16.2 -<span style="color: #BB0000;">26.6</span>  6.93     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 Lake Trout  Embayment -<span style="color: #BB0000;">22.9</span>  16.4 -<span style="color: #BB0000;">24.6</span>  6.97     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 Lake Trout  Embayment -<span style="color: #BB0000;">22.3</span>  16.3 -<span style="color: #BB0000;">22.1</span>  7.95     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span></code></pre></div>
<p>Important note, to run the model successfully columns need to be
names <code>d15n</code>, <code>n1</code>, and <code>l1</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-analysis">Bayesian Analysis<a class="anchor" aria-label="anchor" href="#bayesian-analysis"></a>
</h2>
<p>We can now estimate trophic position for lake trout in an ecoregion
of Lake Ontario.</p>
<p>There are a few things to know about running a Bayesian analysis, I
suggest reading a these resources.</p>
<div class="section level3">
<h3 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h3>
<p>Bayesian analyses rely on supplying uninformed or informed prior
distributions for each parameter (coefficient; predictor) in the model.
The default informed priors for a one source model are the following,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">\Delta N</annotation></semantics></math>
assumes a normal distribution (<code>dn</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>3.4</mn></mrow><annotation encoding="application/x-tex">\mu = 3.4</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\sigma = 0.25</annotation></semantics></math>),
trophic position assumes a uniform distribution (<code>lb = 2</code> and
<code>ub = 10</code>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
assumes a uniform distribution (<code>lb = 0</code> and .
<code>ub = 10</code>), and if informed priors are desired for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>15</mn></msup><msub><mi>N</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">\delta^{15}N_b</annotation></semantics></math>
(<code>n1</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">\mu = 9</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma = 1</annotation></semantics></math>),
we can set the argument <code>bp</code> to <code>TRUE</code> in all
<code>one_source_</code> functions.</p>
</div>
<div class="section level3">
<h3 id="model-convergence">Model convergence<a class="anchor" aria-label="anchor" href="#model-convergence"></a>
</h3>
<p>Some important things to pay attention to are always run at least 2
chains, if the model does not converge you can try to adjust the amount
of samples that are burned-in (discarded; in brms this can be controlled
by the argument <code>warmup</code>), adjust the number of iterative
samples retained (in brms this can be controlled by the argument
<code>iter</code>), and/or adjust the <code>adapt_delta</code> value
using <code>control = list(adapt_delta = 0.95)</code>.</p>
<p>When assessing the model we want R-hat to be 1 or within 0.05 of 1,
we also want a high value for effective sample size (ESS), we want trace
plots to look “grassy” or “catapillery”, and we want posterior
distributions to look relatively normal.</p>
</div>
</div>
<div class="section level2">
<h2 id="estimating-trophic-position">Estimating trophic position<a class="anchor" aria-label="anchor" href="#estimating-trophic-position"></a>
</h2>
<p>We will use functions from {trps} that drop into a {brms} model.
These functions are <code><a href="../reference/one_source_model.html">one_source_model()</a></code> which provides
<code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm()</a></code> the formula structure needed to run a one source
model. Next <code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm()</a></code> needs the structure of the priors which
can be supplied to the <code>prior</code> argument using
<code><a href="../reference/one_source_priors.html">one_source_priors()</a></code>. Lastly, values for these priors are
supplied through the <code>stanvars</code> argument using
<code><a href="../reference/one_source_priors_params.html">one_source_priors_params()</a></code>. You can adjust the mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>),<br>
variance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>),
or upper and lower bounds (<code>lb</code> and <code>ub</code>) for each
prior of the model within <code>one_soruce_priors_params()</code>,
however, only adjust priors if you have a good grasp of Bayesian
frameworks and your study system and species.</p>
<div class="section level3">
<h3 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h3>
<p>Let’s run the model!</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="../reference/one_source_model.html">one_source_model</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="../reference/one_source_priors.html">one_source_priors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="../reference/one_source_priors_params.html">one_source_priors_params</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">combined_iso_os</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Rows containing NAs were excluded from the model.</span></span>
<span><span class="co">#&gt; Compiling Stan program...</span></span>
<span><span class="co">#&gt; Start sampling</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-output">Model output<a class="anchor" aria-label="anchor" href="#model-output"></a>
</h3>
<p>Let’s view the summary of the model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: d15n ~ n1 + dn * (tp - l1) </span></span>
<span><span class="co">#&gt;          dn ~ 1</span></span>
<span><span class="co">#&gt;          tp ~ 1</span></span>
<span><span class="co">#&gt;    Data: combined_iso_os (Number of observations: 14) </span></span>
<span><span class="co">#&gt;   Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 6000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; dn_Intercept     3.38      0.25     2.90     3.87 1.00     2669     2974</span></span>
<span><span class="co">#&gt; tp_Intercept     4.41      0.24     3.97     4.92 1.00     2584     3044</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     1.93      0.43     1.31     2.97 1.00     2510     2532</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>We can see that the R-hat is 1 meaning that variance among and within
chains is equal (See <a href="https://mc-stan.org/rstan/reference/Rhat.html" class="external-link">{rstan}
docmentation on R-hat</a>). and that ESS is quite large, with this
overall meaning the model is converging and fitting accordingly.</p>
</div>
<div class="section level3">
<h3 id="trace-plots">Trace plots<a class="anchor" aria-label="anchor" href="#trace-plots"></a>
</h3>
<p>Let’s view trace plots and posterior distributions for the model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="Estimate_trophic_position_one_source_model_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can see that the trace plots look “grassy” meaning the model is
converging!</p>
</div>
</div>
<div class="section level2">
<h2 id="posterior-draws">Posterior draws<a class="anchor" aria-label="anchor" href="#posterior-draws"></a>
</h2>
<p>Let’s again look at the summary output from the model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: d15n ~ n1 + dn * (tp - l1) </span></span>
<span><span class="co">#&gt;          dn ~ 1</span></span>
<span><span class="co">#&gt;          tp ~ 1</span></span>
<span><span class="co">#&gt;    Data: combined_iso_os (Number of observations: 14) </span></span>
<span><span class="co">#&gt;   Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 6000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; dn_Intercept     3.38      0.25     2.90     3.87 1.00     2669     2974</span></span>
<span><span class="co">#&gt; tp_Intercept     4.41      0.24     3.97     4.92 1.00     2584     3044</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     1.93      0.43     1.31     2.97 1.00     2510     2532</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>We can see that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta N</annotation></semantics></math>
is estimated to be <code>3.38</code> with <code>l-95% CI</code> of
<code>2.90</code>, and <code>u-95% CI</code> of <code>3.87</code>. If we
move down to trophic position (<code>tp</code>) we see trophic position
is estimated to be <code>4.41</code> with <code>l-95% CI</code> of
<code>3.97</code>, and <code>u-95% CI</code> of <code>4.92</code>.</p>
<div class="section level3">
<h3 id="extract-posterior-draws">Extract posterior draws<a class="anchor" aria-label="anchor" href="#extract-posterior-draws"></a>
</h3>
<p>We will use functions from {tidybayes} to do this work. First we will
look at the the names of the variables we want to extract using
<code><a href="https://mjskay.github.io/tidybayes/reference/get_variables.html" class="external-link">get_variables()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/get_variables.html" class="external-link">get_variables</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "b_dn_Intercept" "b_tp_Intercept" "sigma"          "lprior"        </span></span>
<span><span class="co">#&gt;  [5] "lp__"           "accept_stat__"  "stepsize__"     "treedepth__"   </span></span>
<span><span class="co">#&gt;  [9] "n_leapfrog__"   "divergent__"    "energy__"</span></span></code></pre></div>
<p>You will notice that <code>"b_tp_Intercept"</code> is the name of the
variable in the model object that we are most interested in extracting.
We then get posterior draws using <code><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html" class="external-link">gather_draws()</a></code>. I am
going to rename <code>"b_tp_Intercept"</code> to <code>tp</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_draws</span> <span class="op">&lt;-</span> <span class="va">m</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html" class="external-link">gather_draws</a></span><span class="op">(</span><span class="va">b_tp_Intercept</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    .variable <span class="op">=</span> <span class="st">"tp"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Let’s view the <code>post_draws</code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_draws</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6,000 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   .variable [1]</span></span></span>
<span><span class="co">#&gt;    .chain .iteration .draw .variable .value</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1          1     1 tp          4.49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1          2     2 tp          4.94</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1          3     3 tp          4.50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1          4     4 tp          4.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      1          5     5 tp          4.26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      1          6     6 tp          4.34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      1          7     7 tp          4.09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1          8     8 tp          4.46</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1          9     9 tp          4.57</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      1         10    10 tp          4.03</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,990 more rows</span></span></span></code></pre></div>
<p>We can see that this consists of five variables <code>.chain</code>,
<code>.itteration</code>, <code>.draw</code>, <code>.variable</code>
(this will have different variables of interest if you supply
<code><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html" class="external-link">gather_draws()</a></code> with more than one variable),
<code>.value</code> (estimated value).</p>
</div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>Now that we have our posteriors extracted we can plot them. For
comparing trophic position among species or groups, I like using either
violin plots, interval points, or slab plots for posteriors. We can
access violins through {ggplot2} with the later being available in
{ggdist}.</p>
<p>However, for this example we are only going to plot the distribution.
Further below I’ll demonstrate how to run the model itteratively
producing estimates of trophic position for more groups</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">post_draws</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"P(Trophic Position | X)"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Estimate_trophic_position_one_source_model_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Congratulations we have estimate trophic position for Lake Trout. We
will extend this to compare trophic position for Lake Trout among
different regions below with some data already formatted that is in the
package.</p>
</div>
<div class="section level2">
<h2 id="estimate-trophic-position-among-species-or-groups">Estimate trophic position among species or groups<a class="anchor" aria-label="anchor" href="#estimate-trophic-position-among-species-or-groups"></a>
</h2>
<p>this</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin L. Hlina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
